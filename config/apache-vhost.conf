# Apache Virtual Host Configuration
# Simpan file ini di: /etc/apache2/sites-available/toko-inventori.conf
# Enable dengan: sudo a2ensite toko-inventori.conf
# Restart Apache: sudo systemctl restart apache2

<VirtualHost *:80>
    ServerName yourdomain.com
    ServerAlias www.yourdomain.com
    ServerAdmin admin@yourdomain.com
    
    # Document Root harus mengarah ke folder public
    DocumentRoot /var/www/toko-inventori/public
    
    # Konfigurasi untuk folder public
    <Directory /var/www/toko-inventori/public>
        Options -Indexes +FollowSymLinks -MultiViews
        AllowOverride All
        Require all granted
        
        # Enable mod_rewrite
        RewriteEngine On
        
        # Handle Authorization Header
        RewriteCond %{HTTP:Authorization} .
        RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
        
        # Redirect ke index.php
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^ index.php [QSA,L]
    </Directory>
    
    # Proteksi folder aplikasi (jangan bisa diakses dari browser)
    <Directory /var/www/toko-inventori>
        Options -Indexes
        Require all denied
    </Directory>
    
    # Allow akses ke folder public
    <Directory /var/www/toko-inventori/public>
        Require all granted
    </Directory>
    
    # Log files
    ErrorLog ${APACHE_LOG_DIR}/toko-inventori-error.log
    CustomLog ${APACHE_LOG_DIR}/toko-inventori-access.log combined
    
    # PHP Configuration
    php_value upload_max_filesize 20M
    php_value post_max_size 20M
    php_value max_execution_time 300
    php_value memory_limit 256M
</VirtualHost>

# SSL Configuration (Port 443)
# Uncomment setelah install SSL Certificate
# <VirtualHost *:443>
#     ServerName yourdomain.com
#     ServerAlias www.yourdomain.com
#     ServerAdmin admin@yourdomain.com
#     
#     DocumentRoot /var/www/toko-inventori/public
#     
#     <Directory /var/www/toko-inventori/public>
#         Options -Indexes +FollowSymLinks -MultiViews
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     <Directory /var/www/toko-inventori>
#         Options -Indexes
#         Require all denied
#     </Directory>
#     
#     ErrorLog ${APACHE_LOG_DIR}/toko-inventori-ssl-error.log
#     CustomLog ${APACHE_LOG_DIR}/toko-inventori-ssl-access.log combined
#     
#     # SSL Certificate (Let's Encrypt)
#     SSLEngine on
#     SSLCertificateFile /etc/letsencrypt/live/yourdomain.com/fullchain.pem
#     SSLCertificateKeyFile /etc/letsencrypt/live/yourdomain.com/privkey.pem
#     Include /etc/letsencrypt/options-ssl-apache.conf
# </VirtualHost>

# Redirect HTTP to HTTPS (uncomment jika sudah install SSL)
# <VirtualHost *:80>
#     ServerName yourdomain.com
#     ServerAlias www.yourdomain.com
#     Redirect permanent / https://yourdomain.com/
# </VirtualHost>
